<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Class: Ucp::Util::UCP</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Class</strong></td>
          <td class="class-name-in-header">Ucp::Util::UCP</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/ucp/util/ucp_rb.html">
                lib/ucp/util/ucp.rb
                </a>
        <br />
            </td>
        </tr>

        <tr class="top-aligned-row">
            <td><strong>Parent:</strong></td>
            <td>
                Object
            </td>
        </tr>
        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000072">add_char</a>&nbsp;&nbsp;
      <a href="#M000073">add_extchar</a>&nbsp;&nbsp;
      <a href="#M000078">ascii2ira</a>&nbsp;&nbsp;
      <a href="#M000088">decode7bitgsm</a>&nbsp;&nbsp;
      <a href="#M000089">decode_ira</a>&nbsp;&nbsp;
      <a href="#M000094">decode_ucp_msg</a>&nbsp;&nbsp;
      <a href="#M000095">decode_ucp_oadc</a>&nbsp;&nbsp;
      <a href="#M000093">hex2str</a>&nbsp;&nbsp;
      <a href="#M000086">hextobin</a>&nbsp;&nbsp;
      <a href="#M000087">hextobin_reversed</a>&nbsp;&nbsp;
      <a href="#M000074">initialize_ascii2ira</a>&nbsp;&nbsp;
      <a href="#M000090">int2hex</a>&nbsp;&nbsp;
      <a href="#M000083">make_multi_ucps</a>&nbsp;&nbsp;
      <a href="#M000092">make_ucp_result</a>&nbsp;&nbsp;
      <a href="#M000080">multi_ascii2ira</a>&nbsp;&nbsp;
      <a href="#M000077">multi_pack7bits2</a>&nbsp;&nbsp;
      <a href="#M000082">multi_ucs2</a>&nbsp;&nbsp;
      <a href="#M000075">pack7bits</a>&nbsp;&nbsp;
      <a href="#M000076">pack7bits2</a>&nbsp;&nbsp;
      <a href="#M000085">packoadc</a>&nbsp;&nbsp;
      <a href="#M000084">packucs2</a>&nbsp;&nbsp;
      <a href="#M000091">parse_str</a>&nbsp;&nbsp;
      <a href="#M000081">str2ucs2</a>&nbsp;&nbsp;
      <a href="#M000079">utf8_substr</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Class methods</h3>

      <div id="method-M000072" class="method-detail">
        <a name="M000072"></a>

        <div class="method-heading">
          <a href="#M000072" class="method-signature">
          <span class="method-name">add_char</span><span class="method-args">(value,char)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000072-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000072-source">
<pre>
    <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 28</span>
28:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">add_char</span>(<span class="ruby-identifier">value</span>,<span class="ruby-identifier">char</span>)
29:     <span class="ruby-ivar">@gsmtable</span>[<span class="ruby-identifier">char</span>]=<span class="ruby-identifier">value</span>
30:     <span class="ruby-ivar">@asciitable</span>[<span class="ruby-identifier">value</span>]=<span class="ruby-identifier">char</span>
31:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000073" class="method-detail">
        <a name="M000073"></a>

        <div class="method-heading">
          <a href="#M000073" class="method-signature">
          <span class="method-name">add_extchar</span><span class="method-args">(value,char)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000073-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000073-source">
<pre>
    <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 34</span>
34:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">add_extchar</span>(<span class="ruby-identifier">value</span>,<span class="ruby-identifier">char</span>)
35:     <span class="ruby-ivar">@extensiontable</span>[<span class="ruby-identifier">char</span>]=<span class="ruby-identifier">value</span>
36:     <span class="ruby-ivar">@extensiontable_rev</span>[<span class="ruby-identifier">value</span>]=<span class="ruby-identifier">char</span>
37:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000078" class="method-detail">
        <a name="M000078"></a>

        <div class="method-heading">
          <a href="#M000078" class="method-signature">
          <span class="method-name">ascii2ira</span><span class="method-args">(str,max_bytes=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
convert standard string to IRA encoded
</p>
<ul>
<li>an excelent method

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000078-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000078-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 273</span>
273: <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ascii2ira</span>(<span class="ruby-identifier">str</span>,<span class="ruby-identifier">max_bytes</span>=<span class="ruby-keyword kw">nil</span>)
274:   
275:   <span class="ruby-identifier">tainted</span>=<span class="ruby-keyword kw">false</span>  <span class="ruby-comment cmt"># true if not able to convert a character</span>
276:   <span class="ruby-identifier">s</span>=<span class="ruby-value str">&quot;&quot;</span>
277:   <span class="ruby-identifier">idx</span>=<span class="ruby-value">0</span>
278:   <span class="ruby-identifier">str</span>.<span class="ruby-identifier">each_char</span>  { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
279:     <span class="ruby-identifier">gsmchar</span>=<span class="ruby-ivar">@gsmtable</span>[<span class="ruby-identifier">c</span>]
280: 
281:     <span class="ruby-identifier">ext</span>=<span class="ruby-value str">&quot;&quot;</span>
282:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">gsmchar</span>.<span class="ruby-identifier">nil?</span>
283:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@extensiontable</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">c</span>)
284:         <span class="ruby-identifier">ext</span>=<span class="ruby-value str">&quot;1B&quot;</span>
285:         <span class="ruby-identifier">gsmchar</span>=<span class="ruby-ivar">@extensiontable</span>[<span class="ruby-identifier">c</span>]
286:       <span class="ruby-keyword kw">else</span>
287:         <span class="ruby-identifier">gsmchar</span>=<span class="ruby-ivar">@gsmtable</span>[<span class="ruby-value str">&quot; &quot;</span>]
288:         <span class="ruby-identifier">tainted</span>=<span class="ruby-keyword kw">true</span>
289:       <span class="ruby-keyword kw">end</span>
290:     <span class="ruby-keyword kw">end</span>
291: 
292: 
293:     <span class="ruby-identifier">tmp</span>=<span class="ruby-identifier">int2hex</span>(<span class="ruby-identifier">gsmchar</span>)
294: 
295: 
296:     <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">max_bytes</span>.<span class="ruby-identifier">nil?</span>
297:       <span class="ruby-comment cmt"># if adding this character exceeds the max allowed nr of bytes, break</span>
298:       <span class="ruby-keyword kw">if</span> ((<span class="ruby-identifier">tmp</span><span class="ruby-operator">+</span><span class="ruby-identifier">ext</span><span class="ruby-operator">+</span><span class="ruby-identifier">s</span>).<span class="ruby-identifier">length</span><span class="ruby-operator">*</span><span class="ruby-value">7.0</span><span class="ruby-operator">/</span><span class="ruby-value">16</span>).<span class="ruby-identifier">ceil</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">max_bytes</span>
299:         <span class="ruby-keyword kw">break</span>
300:       <span class="ruby-keyword kw">end</span>
301:     <span class="ruby-keyword kw">end</span>
302: 
303:     <span class="ruby-identifier">s</span><span class="ruby-operator">+=</span><span class="ruby-identifier">ext</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>
304:     <span class="ruby-identifier">idx</span><span class="ruby-operator">+=</span>(<span class="ruby-identifier">ext</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>).<span class="ruby-identifier">length</span><span class="ruby-operator">/</span><span class="ruby-value">2</span>
305: 
306:     <span class="ruby-comment cmt"># if reached the max allowed nr of bytes, break</span>
307: <span class="ruby-comment cmt">#    if (s.length*7.0/16).floor==max_bytes</span>
308: <span class="ruby-comment cmt">#      break</span>
309: <span class="ruby-comment cmt">#    end</span>
310: 
311:   }
312: 
313:   <span class="ruby-identifier">required_septets</span>=<span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">/</span><span class="ruby-value">2</span>
314:   <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;idx: #{idx}; req_sep: #{required_septets}&quot;</span>
315:   <span class="ruby-keyword kw">return</span> <span class="ruby-constant">GsmPackedMsg</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">s</span>,<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">utf8_substr</span>(<span class="ruby-identifier">str</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">idx</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>),<span class="ruby-identifier">idx</span>,<span class="ruby-identifier">required_septets</span>,<span class="ruby-identifier">tainted</span>)
316: <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000088" class="method-detail">
        <a name="M000088"></a>

        <div class="method-heading">
          <a href="#M000088" class="method-signature">
          <span class="method-name">decode7bitgsm</span><span class="method-args">(str)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000088-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000088-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 524</span>
524:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">decode7bitgsm</span>(<span class="ruby-identifier">str</span>)
525:     
526:     <span class="ruby-comment cmt"># retirar isto!!</span>
527:     <span class="ruby-comment cmt">#initialize_ascii2ira</span>
528:     
529:     <span class="ruby-identifier">unencoded</span>=<span class="ruby-value str">&quot;&quot;</span>
530: <span class="ruby-comment cmt">#puts &quot;#{str}&quot;</span>
531:     <span class="ruby-identifier">bstr</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">hextobin_reversed</span>(<span class="ruby-identifier">str</span>)
532: <span class="ruby-comment cmt">#puts &quot;#{bstr}&quot;</span>
533: <span class="ruby-comment cmt"># 110 1111 110 1100 110 0001</span>
534: <span class="ruby-comment cmt"># 1000011 1011101 0110111   000</span>
535: 
536:     <span class="ruby-identifier">i</span>=<span class="ruby-identifier">bstr</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">7</span>
537:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">i</span><span class="ruby-operator">&gt;=</span><span class="ruby-value">0</span>
538:       <span class="ruby-identifier">value</span>=<span class="ruby-identifier">bstr</span>[<span class="ruby-identifier">i</span>,<span class="ruby-value">7</span>].<span class="ruby-identifier">to_i</span>(<span class="ruby-value">2</span>)
539:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-value">0x1</span><span class="ruby-constant">B</span>
540:         <span class="ruby-identifier">i</span><span class="ruby-operator">-=</span><span class="ruby-value">7</span>
541:         <span class="ruby-identifier">value</span>=<span class="ruby-ivar">@extensiontable_rev</span>[<span class="ruby-identifier">bstr</span>[<span class="ruby-identifier">i</span>,<span class="ruby-value">7</span>].<span class="ruby-identifier">to_i</span>(<span class="ruby-value">2</span>)]
542:         <span class="ruby-identifier">value</span>=<span class="ruby-value str">&quot; &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
543:         <span class="ruby-identifier">unencoded</span><span class="ruby-operator">+=</span><span class="ruby-identifier">value</span>
544:       <span class="ruby-keyword kw">else</span>
545:         <span class="ruby-identifier">val</span>=<span class="ruby-ivar">@asciitable</span>[<span class="ruby-identifier">value</span>]
546:         <span class="ruby-comment cmt">#puts &quot;value: #{value} ; val: #{val}&quot;</span>
547:         <span class="ruby-identifier">val</span>=<span class="ruby-value str">&quot; &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">nil?</span>
548:         <span class="ruby-identifier">unencoded</span><span class="ruby-operator">+=</span><span class="ruby-identifier">val</span>
549:         <span class="ruby-comment cmt">#unencoded+=value.chr</span>
550:       <span class="ruby-keyword kw">end</span>
551: 
552: 
553:       
554: 
555:       <span class="ruby-identifier">i</span><span class="ruby-operator">-=</span><span class="ruby-value">7</span>
556:     <span class="ruby-keyword kw">end</span>
557: 
558: 
559: <span class="ruby-comment cmt">#    i=0</span>
560: <span class="ruby-comment cmt">#    while i&lt;str.length</span>
561: <span class="ruby-comment cmt">#      hexv=str[i,2]</span>
562: <span class="ruby-comment cmt">#      if &quot;1B&quot;.eql?(hexv)</span>
563: <span class="ruby-comment cmt">#        i+=2</span>
564: <span class="ruby-comment cmt">#        hexv=str[i,2]</span>
565: <span class="ruby-comment cmt">#      end</span>
566: <span class="ruby-comment cmt">#</span>
567: <span class="ruby-comment cmt">#      unencoded+=hexv.to_i(16).chr</span>
568: <span class="ruby-comment cmt">#</span>
569: <span class="ruby-comment cmt">#      i+=2</span>
570: <span class="ruby-comment cmt">#    end</span>
571: 
572: 
573:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">unencoded</span>
574:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000089" class="method-detail">
        <a name="M000089"></a>

        <div class="method-heading">
          <a href="#M000089" class="method-signature">
          <span class="method-name">decode_ira</span><span class="method-args">(str)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000089-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000089-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 578</span>
578:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">decode_ira</span>(<span class="ruby-identifier">str</span>)
579:     <span class="ruby-identifier">unencoded</span>=<span class="ruby-value str">&quot;&quot;</span>
580: 
581:     <span class="ruby-identifier">i</span>=<span class="ruby-value">0</span>
582:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">i</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">str</span>.<span class="ruby-identifier">length</span>
583:       <span class="ruby-identifier">hexv</span>=<span class="ruby-identifier">str</span>[<span class="ruby-identifier">i</span>,<span class="ruby-value">2</span>]
584:       <span class="ruby-keyword kw">if</span> <span class="ruby-value str">&quot;1B&quot;</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-identifier">hexv</span>)
585:         <span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">2</span>
586:         <span class="ruby-identifier">hexv</span>=<span class="ruby-identifier">str</span>[<span class="ruby-identifier">i</span>,<span class="ruby-value">2</span>]
587: 
588:         <span class="ruby-identifier">value</span>=<span class="ruby-ivar">@extensiontable_rev</span>[<span class="ruby-identifier">hexv</span>.<span class="ruby-identifier">to_i</span>(<span class="ruby-value">16</span>)]
589:         <span class="ruby-identifier">value</span>=<span class="ruby-value str">&quot; &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
590:         <span class="ruby-identifier">unencoded</span><span class="ruby-operator">+=</span><span class="ruby-identifier">value</span>
591:       <span class="ruby-keyword kw">else</span>
592:         <span class="ruby-identifier">val</span>=<span class="ruby-ivar">@asciitable</span>[<span class="ruby-identifier">hexv</span>.<span class="ruby-identifier">to_i</span>(<span class="ruby-value">16</span>)]
593:         <span class="ruby-identifier">val</span>=<span class="ruby-value str">&quot; &quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">nil?</span>
594:         <span class="ruby-identifier">unencoded</span><span class="ruby-operator">+=</span><span class="ruby-identifier">val</span>
595:       <span class="ruby-keyword kw">end</span>
596: 
597:       <span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">2</span>
598:     <span class="ruby-keyword kw">end</span>
599: 
600:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">unencoded</span>
601:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000094" class="method-detail">
        <a name="M000094"></a>

        <div class="method-heading">
          <a href="#M000094" class="method-signature">
          <span class="method-name">decode_ucp_msg</span><span class="method-args">(ucp)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000094-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000094-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 812</span>
812:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">decode_ucp_msg</span>(<span class="ruby-identifier">ucp</span>)
813:     <span class="ruby-identifier">text</span>=<span class="ruby-keyword kw">nil</span>
814:     <span class="ruby-identifier">dcs</span>=<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">dcs</span>.<span class="ruby-identifier">to_i</span>(<span class="ruby-value">16</span>)
815: 
816:     <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">dcs</span> <span class="ruby-operator">&amp;</span> <span class="ruby-value">0x0</span><span class="ruby-constant">F</span> <span class="ruby-operator">==</span> <span class="ruby-value">0x01</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">dcs</span> <span class="ruby-operator">&amp;</span> <span class="ruby-value">0x0</span><span class="ruby-constant">F</span> <span class="ruby-operator">==</span> <span class="ruby-value">0x00</span>)
817: 
818:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;30&quot;</span>)
819:         <span class="ruby-identifier">text</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">decode_ira</span>(<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">get_field</span>(<span class="ruby-identifier">:amsg</span>))
820:       <span class="ruby-keyword kw">else</span>
821: 
822:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;51&quot;</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;52&quot;</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;53&quot;</span>)
823:           <span class="ruby-identifier">mt</span>=<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">get_field</span>(<span class="ruby-identifier">:msg</span>)
824:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">mt</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;2&quot;</span>)
825:             <span class="ruby-comment cmt"># numeric message.. return it as it is</span>
826:             <span class="ruby-identifier">text</span>=<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">get_field</span>(<span class="ruby-identifier">:msg</span>)
827:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">mt</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;3&quot;</span>)
828:             <span class="ruby-identifier">text</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">decode_ira</span>(<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">get_field</span>(<span class="ruby-identifier">:msg</span>))
829:           <span class="ruby-keyword kw">else</span>
830:               <span class="ruby-comment cmt"># unexpected &quot;mt&quot; value. return nil explicitely</span>
831:               <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
832:           <span class="ruby-keyword kw">end</span>
833:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;01&quot;</span>)
834:           <span class="ruby-identifier">text</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">decode_ira</span>(<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">get_field</span>(<span class="ruby-identifier">:msg</span>))
835:         <span class="ruby-keyword kw">else</span>
836:           <span class="ruby-comment cmt"># unexpected operation. return nil explicitely</span>
837:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
838:         <span class="ruby-keyword kw">end</span>
839: 
840:       <span class="ruby-keyword kw">end</span>
841:     <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">dcs</span> <span class="ruby-operator">&amp;</span> <span class="ruby-value">0x0</span><span class="ruby-constant">F</span> <span class="ruby-operator">==</span> <span class="ruby-value">0x08</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">dcs</span> <span class="ruby-operator">&amp;</span> <span class="ruby-value">0x0</span><span class="ruby-constant">F</span> <span class="ruby-operator">==</span> <span class="ruby-value">0x09</span>)
842:       <span class="ruby-identifier">str</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">hex2str</span>(<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">get_field</span>(<span class="ruby-identifier">:msg</span>))
843:       <span class="ruby-identifier">text</span>=<span class="ruby-constant">Iconv</span>.<span class="ruby-identifier">iconv</span>(<span class="ruby-value str">&quot;utf-8&quot;</span>,<span class="ruby-value str">&quot;utf-16be&quot;</span>,<span class="ruby-identifier">str</span>).<span class="ruby-identifier">first</span>
844:     <span class="ruby-keyword kw">else</span>
845:       <span class="ruby-comment cmt"># cant decode text; unsupported DCS</span>
846:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
847:     <span class="ruby-keyword kw">end</span>
848: 
849:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">text</span>
850:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000095" class="method-detail">
        <a name="M000095"></a>

        <div class="method-heading">
          <a href="#M000095" class="method-signature">
          <span class="method-name">decode_ucp_oadc</span><span class="method-args">(ucp)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000095-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000095-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 852</span>
852:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">decode_ucp_oadc</span>(<span class="ruby-identifier">ucp</span>)
853:     <span class="ruby-identifier">otoa</span>=<span class="ruby-keyword kw">nil</span>
854:     <span class="ruby-identifier">oadc</span>=<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">get_field</span>(<span class="ruby-identifier">:oadc</span>)
855: 
856:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Ucp51Operation</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Ucp52Operation</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Ucp53Operation</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Ucp54Operation</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Ucp55Operation</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Ucp56Operation</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Ucp57Operation</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Ucp58Operation</span>)
857:       <span class="ruby-identifier">otoa</span>=<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">get_field</span>(<span class="ruby-identifier">:otoa</span>)
858:     <span class="ruby-keyword kw">end</span>
859: 
860:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">otoa</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">otoa</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;1139&quot;</span>)
861:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">oadc</span>
862:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">otoa</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;5039&quot;</span>)
863:       <span class="ruby-comment cmt">#useful_nibbles=oadc[0,2].to_i(16)</span>
864:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">UCP</span>.<span class="ruby-identifier">decode7bitgsm</span>(<span class="ruby-identifier">oadc</span>[<span class="ruby-value">2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>])
865:     <span class="ruby-keyword kw">else</span>
866:       <span class="ruby-comment cmt">#</span>
867:     <span class="ruby-keyword kw">end</span>
868: 
869:     <span class="ruby-comment cmt"># by default, return oadc</span>
870:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">oadc</span>
871:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000093" class="method-detail">
        <a name="M000093"></a>

        <div class="method-heading">
          <a href="#M000093" class="method-signature">
          <span class="method-name">hex2str</span><span class="method-args">(hexstr)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000093-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000093-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 806</span>
806:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">hex2str</span>(<span class="ruby-identifier">hexstr</span>)
807:     <span class="ruby-identifier">str</span>=<span class="ruby-value str">&quot;&quot;</span>
808:     <span class="ruby-identifier">hexstr</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp re">/../</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span> <span class="ruby-identifier">tuple</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">str</span><span class="ruby-operator">+=</span><span class="ruby-identifier">tuple</span>.<span class="ruby-identifier">hex</span>.<span class="ruby-identifier">chr</span> }
809:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">str</span>
810:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000086" class="method-detail">
        <a name="M000086"></a>

        <div class="method-heading">
          <a href="#M000086" class="method-signature">
          <span class="method-name">hextobin</span><span class="method-args">(hstr)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000086-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000086-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 488</span>
488:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">hextobin</span>(<span class="ruby-identifier">hstr</span>)
489:     <span class="ruby-identifier">bstr</span>=<span class="ruby-value str">&quot;&quot;</span>
490:     <span class="ruby-identifier">i</span>=<span class="ruby-value">0</span>
491:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">i</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">hstr</span>.<span class="ruby-identifier">length</span>
492:       <span class="ruby-identifier">tmp</span>=<span class="ruby-identifier">hstr</span>[<span class="ruby-identifier">i</span>,<span class="ruby-value">2</span>].<span class="ruby-identifier">to_i</span>(<span class="ruby-value">16</span>).<span class="ruby-identifier">to_s</span>(<span class="ruby-value">2</span>)
493: 
494:       <span class="ruby-identifier">nfillbits</span>=<span class="ruby-value">8</span><span class="ruby-operator">-</span><span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">length</span>
495:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">nfillbits!</span>=<span class="ruby-value">0</span>
496:         <span class="ruby-identifier">tmp</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">*</span><span class="ruby-identifier">nfillbits</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>
497:       <span class="ruby-keyword kw">end</span>
498: 
499:      <span class="ruby-identifier">bstr</span><span class="ruby-operator">+=</span><span class="ruby-identifier">tmp</span>
500:      <span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">2</span>
501:     <span class="ruby-keyword kw">end</span>
502:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">bstr</span>
503:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000087" class="method-detail">
        <a name="M000087"></a>

        <div class="method-heading">
          <a href="#M000087" class="method-signature">
          <span class="method-name">hextobin_reversed</span><span class="method-args">(hstr)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000087-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000087-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 506</span>
506:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">hextobin_reversed</span>(<span class="ruby-identifier">hstr</span>)
507:     <span class="ruby-identifier">bstr</span>=<span class="ruby-value str">&quot;&quot;</span>
508:     <span class="ruby-identifier">i</span>=<span class="ruby-value">0</span>
509:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">i</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">hstr</span>.<span class="ruby-identifier">length</span>
510:       <span class="ruby-identifier">tmp</span>=<span class="ruby-identifier">hstr</span>[<span class="ruby-identifier">i</span>,<span class="ruby-value">2</span>].<span class="ruby-identifier">to_i</span>(<span class="ruby-value">16</span>).<span class="ruby-identifier">to_s</span>(<span class="ruby-value">2</span>)
511: 
512:       <span class="ruby-identifier">nfillbits</span>=<span class="ruby-value">8</span><span class="ruby-operator">-</span><span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">length</span>
513:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">nfillbits!</span>=<span class="ruby-value">0</span>
514:         <span class="ruby-identifier">tmp</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">*</span><span class="ruby-identifier">nfillbits</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>
515:       <span class="ruby-keyword kw">end</span>
516: 
517:      <span class="ruby-identifier">bstr</span>=<span class="ruby-identifier">tmp</span><span class="ruby-operator">+</span><span class="ruby-identifier">bstr</span>
518:      <span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">2</span>
519:     <span class="ruby-keyword kw">end</span>
520:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">bstr</span>
521:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000074" class="method-detail">
        <a name="M000074"></a>

        <div class="method-heading">
          <a href="#M000074" class="method-signature">
          <span class="method-name">initialize_ascii2ira</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000074-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000074-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 39</span>
 39:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">initialize_ascii2ira</span>
 40:     
 41:     (<span class="ruby-value str">'A'</span><span class="ruby-operator">..</span><span class="ruby-value str">'Z'</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
 42:       <span class="ruby-identifier">add_char</span>(<span class="ruby-identifier">c</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">c</span>)
 43:     }
 44:     (<span class="ruby-value str">'a'</span><span class="ruby-operator">..</span><span class="ruby-value str">'z'</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
 45:       <span class="ruby-comment cmt">#@gsmtable[c]=c[0]</span>
 46:       <span class="ruby-comment cmt">#@asciitable[c[0]]=c</span>
 47:       <span class="ruby-identifier">add_char</span>(<span class="ruby-identifier">c</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">c</span>)
 48:     }
 49:     (<span class="ruby-value str">'0'</span><span class="ruby-operator">..</span><span class="ruby-value str">'9'</span>).<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
 50:       <span class="ruby-identifier">add_char</span>(<span class="ruby-identifier">c</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">c</span>)
 51:     }
 52: 
 53: 
 54:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x00</span>,<span class="ruby-value str">&quot;@&quot;</span>)
 55:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x01</span>,<span class="ruby-value str">&quot;£&quot;</span>)
 56:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x02</span>,<span class="ruby-value str">&quot;$&quot;</span>)
 57:     <span class="ruby-comment cmt">#add_char(0x03,&quot; &quot;)</span>
 58:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x04</span>,<span class="ruby-value str">&quot;è&quot;</span>)
 59:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x05</span>,<span class="ruby-value str">&quot;é&quot;</span>)
 60:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x06</span>,<span class="ruby-value str">&quot;ù&quot;</span>)
 61:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x07</span>,<span class="ruby-value str">&quot;ì&quot;</span>)
 62:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x08</span>,<span class="ruby-value str">&quot;ò&quot;</span>)
 63:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x09</span>,<span class="ruby-value str">&quot;Ç&quot;</span>)
 64:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x0</span><span class="ruby-constant">A</span>,<span class="ruby-value str">&quot;\n&quot;</span>)
 65:     <span class="ruby-comment cmt">#add_char(0x0B,&quot; &quot;)</span>
 66:     <span class="ruby-comment cmt">#add_char(0x0C,&quot; &quot;)</span>
 67:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x0</span><span class="ruby-constant">D</span>,<span class="ruby-value str">&quot;\r&quot;</span>)
 68:     <span class="ruby-comment cmt">#add_char(0x0E,&quot;A&quot;)</span>
 69:     <span class="ruby-comment cmt">#add_char(0x0F,&quot;a&quot;)</span>
 70: 
 71:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x1</span><span class="ruby-constant">F</span>,<span class="ruby-value str">&quot;É&quot;</span>)
 72: 
 73: 
 74: 
 75:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x20</span>,<span class="ruby-value str">&quot; &quot;</span>)
 76:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x21</span>,<span class="ruby-value str">&quot;!&quot;</span>)
 77:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x22</span>,<span class="ruby-value str">'&quot;'</span>)
 78:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x23</span>,<span class="ruby-value str">&quot;#&quot;</span>)
 79:     <span class="ruby-comment cmt">#add_char(0x24,&quot; &quot;)</span>
 80:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x25</span>,<span class="ruby-value str">&quot;%&quot;</span>)
 81:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x26</span>,<span class="ruby-value str">&quot;&amp;&quot;</span>)
 82:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x27</span>,<span class="ruby-value str">&quot;'&quot;</span>)
 83:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x28</span>,<span class="ruby-value str">&quot;(&quot;</span>)
 84:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x29</span>,<span class="ruby-value str">&quot;)&quot;</span>)
 85:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x2</span><span class="ruby-constant">A</span>,<span class="ruby-value str">&quot;*&quot;</span>)
 86:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x2</span><span class="ruby-constant">B</span>,<span class="ruby-value str">&quot;+&quot;</span>)
 87:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x2</span><span class="ruby-constant">C</span>,<span class="ruby-value str">&quot;,&quot;</span>)
 88:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x2</span><span class="ruby-constant">D</span>,<span class="ruby-value str">&quot;-&quot;</span>)
 89:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x2</span><span class="ruby-constant">E</span>,<span class="ruby-value str">&quot;.&quot;</span>)
 90:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x2</span><span class="ruby-constant">F</span>,<span class="ruby-value str">&quot;/&quot;</span>)
 91: 
 92:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x3</span><span class="ruby-constant">A</span>,<span class="ruby-value str">&quot;:&quot;</span>)
 93:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x3</span><span class="ruby-constant">B</span>,<span class="ruby-value str">&quot;;&quot;</span>)
 94:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x3</span><span class="ruby-constant">C</span>,<span class="ruby-value str">&quot;&lt;&quot;</span>)
 95:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x3</span><span class="ruby-constant">D</span>,<span class="ruby-value str">&quot;=&quot;</span>)
 96:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x3</span><span class="ruby-constant">E</span>,<span class="ruby-value str">&quot;&gt;&quot;</span>)
 97:     <span class="ruby-identifier">add_char</span>(<span class="ruby-value">0x3</span><span class="ruby-constant">F</span>,<span class="ruby-value str">&quot;?&quot;</span>)
 98: 
 99: 
100: 
101:     <span class="ruby-comment cmt">#@extensiontable[&quot;€&quot;]=0x65</span>
102:     <span class="ruby-comment cmt">#@extensiontable_rev[0x65]=&quot;€&quot;</span>
103:     <span class="ruby-identifier">add_extchar</span>(<span class="ruby-value">0x65</span>,<span class="ruby-value str">&quot;€&quot;</span>)
104:     <span class="ruby-identifier">add_extchar</span>(<span class="ruby-value">0x14</span>,<span class="ruby-value str">&quot;^&quot;</span>)
105:     <span class="ruby-identifier">add_extchar</span>(<span class="ruby-value">0x28</span>,<span class="ruby-value str">&quot;{&quot;</span>)
106:     <span class="ruby-identifier">add_extchar</span>(<span class="ruby-value">0x29</span>,<span class="ruby-value str">&quot;}&quot;</span>)
107:     <span class="ruby-identifier">add_extchar</span>(<span class="ruby-value">0x2</span><span class="ruby-constant">F</span>,<span class="ruby-value str">&quot;\\&quot;</span>)
108:     <span class="ruby-identifier">add_extchar</span>(<span class="ruby-value">0x3</span><span class="ruby-constant">C</span>,<span class="ruby-value str">&quot;[&quot;</span>)
109:     <span class="ruby-identifier">add_extchar</span>(<span class="ruby-value">0x3</span><span class="ruby-constant">D</span>,<span class="ruby-value str">&quot;~&quot;</span>)
110:     <span class="ruby-identifier">add_extchar</span>(<span class="ruby-value">0x3</span><span class="ruby-constant">E</span>,<span class="ruby-value str">&quot;]&quot;</span>)
111:     <span class="ruby-identifier">add_extchar</span>(<span class="ruby-value">0x40</span>,<span class="ruby-value str">&quot;|&quot;</span>)
112: 
113: 
114: 
115:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000090" class="method-detail">
        <a name="M000090"></a>

        <div class="method-heading">
          <a href="#M000090" class="method-signature">
          <span class="method-name">int2hex</span><span class="method-args">(i,max_nibbles=2)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000090-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000090-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 606</span>
606:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">int2hex</span>(<span class="ruby-identifier">i</span>,<span class="ruby-identifier">max_nibbles</span>=<span class="ruby-value">2</span>)
607:     <span class="ruby-identifier">tmp</span>=<span class="ruby-identifier">i</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-value">16</span>).<span class="ruby-identifier">upcase</span>
608:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">%</span><span class="ruby-value">2</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span>
609:       <span class="ruby-identifier">tmp</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>
610:     <span class="ruby-keyword kw">end</span>
611: 
612:     <span class="ruby-identifier">remaining_nibbles</span>=<span class="ruby-identifier">max_nibbles</span><span class="ruby-operator">-</span><span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">length</span>
613:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">remaining_nibbles</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>
614:       <span class="ruby-identifier">tmp</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">*</span><span class="ruby-identifier">remaining_nibbles</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>;
615:     <span class="ruby-keyword kw">end</span>
616: 
617:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">tmp</span>
618:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000083" class="method-detail">
        <a name="M000083"></a>

        <div class="method-heading">
          <a href="#M000083" class="method-signature">
          <span class="method-name">make_multi_ucps</span><span class="method-args">(originator,recipient,message,mr=0)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000083-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000083-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 413</span>
413: <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">make_multi_ucps</span>(<span class="ruby-identifier">originator</span>,<span class="ruby-identifier">recipient</span>,<span class="ruby-identifier">message</span>,<span class="ruby-identifier">mr</span>=<span class="ruby-value">0</span>)
414:   <span class="ruby-identifier">ucps</span>=[]
415:   
416:   <span class="ruby-identifier">gsm7bit_encodable</span>=<span class="ruby-keyword kw">false</span>
417: 
418:   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">gsm7bit_encodable</span>
419:     <span class="ruby-identifier">gsmparts</span>= <span class="ruby-constant">UCP</span>.<span class="ruby-identifier">multi_ascii2ira</span>(<span class="ruby-identifier">message</span>,<span class="ruby-value">134</span>)
420:   <span class="ruby-keyword kw">else</span>
421:     <span class="ruby-identifier">gsmparts</span>= <span class="ruby-constant">UCP</span>.<span class="ruby-identifier">multi_ucs2</span>(<span class="ruby-identifier">message</span>,<span class="ruby-value">134</span>)
422:   <span class="ruby-keyword kw">end</span>
423: 
424: 
425:   <span class="ruby-identifier">part_nr</span>=<span class="ruby-value">1</span>
426:   <span class="ruby-identifier">gsmparts</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">gsmpart</span><span class="ruby-operator">|</span>
427:     <span class="ruby-identifier">ucp</span>=<span class="ruby-constant">Ucp51Operation</span>.<span class="ruby-identifier">new</span>
428:     <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">basic_submit</span>(<span class="ruby-identifier">originator</span>,<span class="ruby-identifier">recipient</span>,<span class="ruby-keyword kw">nil</span>)
429:     
430:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">gsmparts</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>
431:       <span class="ruby-comment cmt"># concatenated xser</span>
432:       <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">add_xser</span>(<span class="ruby-value str">&quot;01&quot;</span>,<span class="ruby-value str">&quot;050003&quot;</span><span class="ruby-operator">+</span><span class="ruby-constant">UCP</span>.<span class="ruby-identifier">int2hex</span>(<span class="ruby-identifier">mr</span>)<span class="ruby-operator">+</span><span class="ruby-constant">UCP</span>.<span class="ruby-identifier">int2hex</span>(<span class="ruby-identifier">gsmparts</span>.<span class="ruby-identifier">length</span>)<span class="ruby-operator">+</span><span class="ruby-constant">UCP</span>.<span class="ruby-identifier">int2hex</span>(<span class="ruby-identifier">part_nr</span>))
433:     <span class="ruby-keyword kw">end</span>
434:     
435:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">gsm7bit_encodable</span>
436:       <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">set_fields</span>({<span class="ruby-identifier">:mt=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">3</span>, <span class="ruby-identifier">:msg=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">gsmpart</span>.<span class="ruby-identifier">encoded</span>})
437:       <span class="ruby-comment cmt"># DCS xser</span>
438:       <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">add_xser</span>(<span class="ruby-value str">&quot;02&quot;</span>,<span class="ruby-value str">&quot;01&quot;</span>)
439:     <span class="ruby-keyword kw">else</span>
440:       <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">set_fields</span>({<span class="ruby-identifier">:msg=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">gsmpart</span>.<span class="ruby-identifier">encoded</span>,<span class="ruby-identifier">:mt=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">4</span>,<span class="ruby-identifier">:nb=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">gsmpart</span>.<span class="ruby-identifier">encoded</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">*</span><span class="ruby-value">4</span>})
441:       <span class="ruby-comment cmt"># DCS xser</span>
442:       <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">add_xser</span>(<span class="ruby-value str">&quot;02&quot;</span>,<span class="ruby-value str">&quot;08&quot;</span>)
443:     <span class="ruby-keyword kw">end</span>
444: 
445:     <span class="ruby-comment cmt">#ucp.trn=UCP.int2hex(initial_trn)</span>
446:     <span class="ruby-comment cmt">#initial_trn+=1</span>
447:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;part: #{ucp.to_s}&quot;</span>
448:     <span class="ruby-identifier">ucps</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">ucp</span>
449:     <span class="ruby-identifier">part_nr</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
450:   }
451:   <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ucps</span>
452: <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000092" class="method-detail">
        <a name="M000092"></a>

        <div class="method-heading">
          <a href="#M000092" class="method-signature">
          <span class="method-name">make_ucp_result</span><span class="method-args">(ucp)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
usado para construir uma resposta <a href="UCP.html">UCP</a> a partir dum
<a href="UCP.html">UCP</a>
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000092-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000092-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 755</span>
755:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">make_ucp_result</span>(<span class="ruby-identifier">ucp</span>)
756:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;make_ucp_result(#{ucp.to_s})&quot;</span>
757: 
758:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">nil?</span>
759:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
760:     <span class="ruby-keyword kw">end</span>
761: 
762:     <span class="ruby-identifier">trn</span>=<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">trn</span>
763:     <span class="ruby-comment cmt">#puts &quot;#{trn}&quot;</span>
764:     <span class="ruby-comment cmt"># length</span>
765:     <span class="ruby-identifier">operation_type</span>=<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">operation_type</span>
766:     <span class="ruby-comment cmt">#puts &quot;#{operation_type}&quot;</span>
767:     <span class="ruby-identifier">operation</span>=<span class="ruby-identifier">ucp</span>.<span class="ruby-identifier">operation</span>
768:     <span class="ruby-comment cmt">#puts &quot;#{operation}&quot;</span>
769: 
770:     <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-keyword kw">nil</span>
771: 
772:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;01&quot;</span>)
773:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp01Result</span>.<span class="ruby-identifier">new</span>
774:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;30&quot;</span>)
775:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp30Result</span>.<span class="ruby-identifier">new</span>
776:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;31&quot;</span>)
777:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp31Result</span>.<span class="ruby-identifier">new</span>
778:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;51&quot;</span>)
779:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp51Result</span>.<span class="ruby-identifier">new</span>
780:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;52&quot;</span>)
781:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp52Result</span>.<span class="ruby-identifier">new</span>
782:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;53&quot;</span>)
783:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp53Result</span>.<span class="ruby-identifier">new</span>
784:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;54&quot;</span>)
785:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp54Result</span>.<span class="ruby-identifier">new</span>
786:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;55&quot;</span>)
787:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp55Result</span>.<span class="ruby-identifier">new</span>
788:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;56&quot;</span>)
789:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp56Result</span>.<span class="ruby-identifier">new</span>
790:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;57&quot;</span>)
791:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp57Result</span>.<span class="ruby-identifier">new</span>
792:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;58&quot;</span>)
793:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp58Result</span>.<span class="ruby-identifier">new</span>
794:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;60&quot;</span>)
795:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp60Result</span>.<span class="ruby-identifier">new</span>
796:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;61&quot;</span>)
797:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp61Result</span>.<span class="ruby-identifier">new</span>
798:     <span class="ruby-keyword kw">else</span>
799:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
800:     <span class="ruby-keyword kw">end</span>
801: 
802:     <span class="ruby-identifier">ucpmsg</span>.<span class="ruby-identifier">trn</span>=<span class="ruby-identifier">trn</span>
803:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ucpmsg</span>
804:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000080" class="method-detail">
        <a name="M000080"></a>

        <div class="method-heading">
          <a href="#M000080" class="method-signature">
          <span class="method-name">multi_ascii2ira</span><span class="method-args">(str,max_bytes)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000080-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000080-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 330</span>
330: <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">multi_ascii2ira</span>(<span class="ruby-identifier">str</span>,<span class="ruby-identifier">max_bytes</span>)
331:   <span class="ruby-identifier">msgparts</span>=[]
332:   <span class="ruby-identifier">idx</span>=<span class="ruby-value">0</span>
333: 
334:   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">jlength</span><span class="ruby-operator">&lt;=</span><span class="ruby-value">160</span>
335:     <span class="ruby-identifier">packedmsg</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">ascii2ira</span>(<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">utf8_substr</span>(<span class="ruby-identifier">str</span>,<span class="ruby-identifier">idx</span>),<span class="ruby-value">140</span>)
336:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;pckd_chars: #{packedmsg.chars}; strlen: #{str.jlength}&quot;</span>
337:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">packedmsg</span>.<span class="ruby-identifier">chars</span><span class="ruby-operator">==</span><span class="ruby-identifier">str</span>.<span class="ruby-identifier">jlength</span>
338:       <span class="ruby-identifier">msgparts</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">packedmsg</span>
339:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">msgparts</span>
340:     <span class="ruby-keyword kw">end</span>
341:   <span class="ruby-keyword kw">end</span>
342: 
343:   <span class="ruby-keyword kw">while</span> <span class="ruby-keyword kw">true</span>
344:     <span class="ruby-comment cmt">#packedmsg=UCP.ascii2ira(str[idx..-1],max_bytes)</span>
345:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;bla: #{UCP.utf8_substr(str,idx)}&quot;</span>
346:     <span class="ruby-identifier">packedmsg</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">ascii2ira</span>(<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">utf8_substr</span>(<span class="ruby-identifier">str</span>,<span class="ruby-identifier">idx</span>),<span class="ruby-identifier">max_bytes</span>)
347:     <span class="ruby-identifier">msgparts</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">packedmsg</span>
348:     <span class="ruby-comment cmt">#break</span>
349:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;idx: #{idx}; pckd_chars: #{packedmsg.chars}; strlen: #{str.jlength}&quot;</span>
350:     
351:     <span class="ruby-comment cmt">#puts &quot;sL: #{str[0,idx+packedmsg.chars]} ; #{str[0,idx+packedmsg.chars].length}#&quot;</span>
352:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;sL: #{UCP.utf8_substr(str,idx,idx+packedmsg.chars- 1)} ; #{str[0,idx+packedmsg.chars].length}#&quot;</span>
353:     
354:     <span class="ruby-comment cmt">#if idx+packedmsg.chars&lt;str.length</span>
355:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">idx</span><span class="ruby-operator">+</span><span class="ruby-identifier">packedmsg</span>.<span class="ruby-identifier">chars</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">str</span>.<span class="ruby-identifier">jlength</span>
356:       <span class="ruby-identifier">idx</span><span class="ruby-operator">+=</span><span class="ruby-identifier">packedmsg</span>.<span class="ruby-identifier">chars</span>
357:     <span class="ruby-keyword kw">else</span>
358:       <span class="ruby-keyword kw">break</span>
359:     <span class="ruby-keyword kw">end</span>
360:   <span class="ruby-keyword kw">end</span>
361:   <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">msgparts</span>
362: <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000077" class="method-detail">
        <a name="M000077"></a>

        <div class="method-heading">
          <a href="#M000077" class="method-signature">
          <span class="method-name">multi_pack7bits2</span><span class="method-args">(str,max_bytes)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000077-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000077-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 255</span>
255: <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">multi_pack7bits2</span>(<span class="ruby-identifier">str</span>,<span class="ruby-identifier">max_bytes</span>)
256:   <span class="ruby-identifier">msgparts</span>=[]
257:   <span class="ruby-identifier">idx</span>=<span class="ruby-value">0</span>
258:   <span class="ruby-keyword kw">while</span> <span class="ruby-keyword kw">true</span>
259:     <span class="ruby-identifier">packedmsg</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">pack7bits2</span>(<span class="ruby-identifier">str</span>[<span class="ruby-identifier">idx</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>],<span class="ruby-identifier">max_bytes</span>)
260:     <span class="ruby-identifier">msgparts</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">packedmsg</span>
261:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">idx</span><span class="ruby-operator">+</span><span class="ruby-identifier">packedmsg</span>.<span class="ruby-identifier">chars</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">str</span>.<span class="ruby-identifier">length</span>
262:       <span class="ruby-identifier">idx</span><span class="ruby-operator">+=</span><span class="ruby-identifier">packedmsg</span>.<span class="ruby-identifier">chars</span>
263:     <span class="ruby-keyword kw">else</span>
264:       <span class="ruby-keyword kw">break</span>
265:     <span class="ruby-keyword kw">end</span>
266:   <span class="ruby-keyword kw">end</span>
267:   <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">msgparts</span>
268: <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000082" class="method-detail">
        <a name="M000082"></a>

        <div class="method-heading">
          <a href="#M000082" class="method-signature">
          <span class="method-name">multi_ucs2</span><span class="method-args">(str,max_bytes)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000082-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000082-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 380</span>
380: <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">multi_ucs2</span>(<span class="ruby-identifier">str</span>,<span class="ruby-identifier">max_bytes</span>)
381:   <span class="ruby-identifier">msgparts</span>=[]
382:   <span class="ruby-identifier">idx</span>=<span class="ruby-value">0</span>
383: 
384:   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">jlength</span><span class="ruby-operator">&lt;=</span><span class="ruby-value">70</span>
385:     <span class="ruby-identifier">packedmsg</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">str2ucs2</span>(<span class="ruby-identifier">str</span>,<span class="ruby-value">140</span>)
386:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;pckd_chars: #{packedmsg.chars}; strlen: #{str.jlength}&quot;</span>
387:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">packedmsg</span>.<span class="ruby-identifier">chars</span><span class="ruby-operator">==</span><span class="ruby-identifier">str</span>.<span class="ruby-identifier">jlength</span>
388:       <span class="ruby-identifier">msgparts</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">packedmsg</span>
389:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">msgparts</span>
390:     <span class="ruby-keyword kw">end</span>
391:   <span class="ruby-keyword kw">end</span>
392: 
393:   <span class="ruby-keyword kw">while</span> <span class="ruby-keyword kw">true</span>
394:     
395:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;bla: #{UCP.utf8_substr(str,idx)}&quot;</span>
396:     <span class="ruby-identifier">packedmsg</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">str2ucs2</span>(<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">utf8_substr</span>(<span class="ruby-identifier">str</span>,<span class="ruby-identifier">idx</span>),<span class="ruby-identifier">max_bytes</span>)
397:     <span class="ruby-identifier">msgparts</span><span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">packedmsg</span>
398:     <span class="ruby-comment cmt">#break</span>
399:     <span class="ruby-comment cmt">#puts &quot;idx: #{idx}; pckd_chars: #{packedmsg.chars}; strlen: #{str.jlength}&quot;</span>
400:     <span class="ruby-comment cmt">#puts &quot;sL: #{UCP.utf8_substr(str,idx,idx+packedmsg.chars- 1)} ; #{str[0,idx+packedmsg.chars].length}#&quot;</span>
401:     
402:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">idx</span><span class="ruby-operator">+</span><span class="ruby-identifier">packedmsg</span>.<span class="ruby-identifier">chars</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">str</span>.<span class="ruby-identifier">jlength</span>
403:       <span class="ruby-identifier">idx</span><span class="ruby-operator">+=</span><span class="ruby-identifier">packedmsg</span>.<span class="ruby-identifier">chars</span>
404:     <span class="ruby-keyword kw">else</span>
405:       <span class="ruby-keyword kw">break</span>
406:     <span class="ruby-keyword kw">end</span>
407:   <span class="ruby-keyword kw">end</span>
408:   <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">msgparts</span>
409: <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000075" class="method-detail">
        <a name="M000075"></a>

        <div class="method-heading">
          <a href="#M000075" class="method-signature">
          <span class="method-name">pack7bits</span><span class="method-args">(str)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000075-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000075-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 117</span>
117:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">pack7bits</span>(<span class="ruby-identifier">str</span>)
118:     <span class="ruby-comment cmt">#UCP.initialize_ascii2ira</span>
119:     
120:     <span class="ruby-identifier">s</span>=<span class="ruby-value str">&quot;&quot;</span>
121:     <span class="ruby-identifier">str</span>.<span class="ruby-identifier">each_char</span>  { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
122: 
123:       <span class="ruby-identifier">ext</span>=<span class="ruby-value str">&quot;&quot;</span>
124:       <span class="ruby-identifier">gsmchar</span>=<span class="ruby-ivar">@gsmtable</span>[<span class="ruby-identifier">c</span>]
125: 
126:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">gsmchar</span>.<span class="ruby-identifier">nil?</span>
127:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@extensiontable</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">c</span>)
128:           <span class="ruby-identifier">ext</span>=<span class="ruby-value str">&quot;0011011&quot;</span> <span class="ruby-comment cmt"># 1B</span>
129:           <span class="ruby-identifier">gsmchar</span>=<span class="ruby-ivar">@extensiontable</span>[<span class="ruby-identifier">c</span>]
130:         <span class="ruby-keyword kw">else</span>
131:           <span class="ruby-identifier">gsmchar</span>=<span class="ruby-ivar">@gsmtable</span>[<span class="ruby-value str">&quot; &quot;</span>]
132:         <span class="ruby-keyword kw">end</span>
133:       <span class="ruby-keyword kw">end</span>
134: 
135:       <span class="ruby-comment cmt">#gsmchar=c[0]</span>
136:       <span class="ruby-comment cmt">#puts &quot;#{c} : #{gsmchar} xxx&quot;</span>
137:       <span class="ruby-comment cmt">#gsmchar=@gsmtable[&quot; &quot;] if gsmchar.nil?</span>
138:       
139:       <span class="ruby-identifier">tmp</span>= <span class="ruby-identifier">gsmchar</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-value">2</span>)
140: 
141:       <span class="ruby-identifier">resto</span>=<span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">%</span><span class="ruby-value">7</span>
142:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">resto!</span>=<span class="ruby-value">0</span>
143:         <span class="ruby-identifier">nfillbits</span>=<span class="ruby-value">7</span><span class="ruby-operator">-</span><span class="ruby-identifier">resto</span> <span class="ruby-comment cmt"># 8 ou 7??</span>
144:         <span class="ruby-identifier">tmp</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">*</span><span class="ruby-identifier">nfillbits</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>
145:       <span class="ruby-keyword kw">end</span>
146:       
147:       <span class="ruby-identifier">s</span>=<span class="ruby-identifier">tmp</span><span class="ruby-operator">+</span><span class="ruby-identifier">ext</span><span class="ruby-operator">+</span><span class="ruby-identifier">s</span>
148: 
149:     }
150: 
151:     <span class="ruby-identifier">resto</span>=<span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">%</span><span class="ruby-value">8</span>
152:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">resto!</span>=<span class="ruby-value">0</span>
153:       <span class="ruby-identifier">nfillbits</span>=<span class="ruby-value">8</span><span class="ruby-operator">-</span><span class="ruby-identifier">resto</span>
154:       <span class="ruby-identifier">s</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">*</span><span class="ruby-identifier">nfillbits</span><span class="ruby-operator">+</span><span class="ruby-identifier">s</span>
155:     <span class="ruby-keyword kw">end</span>
156: 
157:     <span class="ruby-comment cmt">#puts &quot;S: #{s}&quot;</span>
158:     
159:     <span class="ruby-identifier">i</span>=<span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">8</span>
160:     <span class="ruby-identifier">hexstr</span>=<span class="ruby-value str">&quot;&quot;</span>
161:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">i</span><span class="ruby-operator">&gt;=</span><span class="ruby-value">0</span>
162:       <span class="ruby-identifier">c</span>=<span class="ruby-identifier">s</span>[<span class="ruby-identifier">i</span>,<span class="ruby-value">8</span>]
163: 
164:       <span class="ruby-identifier">tmp</span>=<span class="ruby-identifier">c</span>.<span class="ruby-identifier">to_i</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">to_s</span>(<span class="ruby-value">16</span>).<span class="ruby-identifier">upcase</span>
165:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">==</span><span class="ruby-value">1</span>
166:         <span class="ruby-identifier">tmp</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>
167:       <span class="ruby-keyword kw">end</span>
168: <span class="ruby-comment cmt">#      puts tmp</span>
169:       <span class="ruby-identifier">hexstr</span><span class="ruby-operator">+=</span><span class="ruby-identifier">tmp</span>
170:       <span class="ruby-identifier">i</span><span class="ruby-operator">-=</span><span class="ruby-value">8</span>
171:     <span class="ruby-keyword kw">end</span>
172:       
173:     
174: 
175:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">hexstr</span>
176:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000076" class="method-detail">
        <a name="M000076"></a>

        <div class="method-heading">
          <a href="#M000076" class="method-signature">
          <span class="method-name">pack7bits2</span><span class="method-args">(str,max_bytes)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000076-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000076-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 179</span>
179:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">pack7bits2</span>(<span class="ruby-identifier">str</span>,<span class="ruby-identifier">max_bytes</span>)
180: 
181:     <span class="ruby-identifier">tainted</span>=<span class="ruby-keyword kw">false</span>
182:     <span class="ruby-identifier">s</span>=<span class="ruby-value str">&quot;&quot;</span>
183:     <span class="ruby-identifier">idx</span>=<span class="ruby-value">0</span>
184:     <span class="ruby-identifier">str</span>.<span class="ruby-identifier">each_char</span>  { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
185: 
186:       <span class="ruby-identifier">ext</span>=<span class="ruby-value str">&quot;&quot;</span>
187:       <span class="ruby-identifier">gsmchar</span>=<span class="ruby-ivar">@gsmtable</span>[<span class="ruby-identifier">c</span>]
188: 
189:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">gsmchar</span>.<span class="ruby-identifier">nil?</span>
190:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@extensiontable</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">c</span>)
191:           <span class="ruby-identifier">ext</span>=<span class="ruby-value str">&quot;0011011&quot;</span> <span class="ruby-comment cmt"># 1B</span>
192:           <span class="ruby-identifier">gsmchar</span>=<span class="ruby-ivar">@extensiontable</span>[<span class="ruby-identifier">c</span>]
193:         <span class="ruby-keyword kw">else</span>
194:           <span class="ruby-identifier">gsmchar</span>=<span class="ruby-ivar">@gsmtable</span>[<span class="ruby-value str">&quot; &quot;</span>]
195:           <span class="ruby-identifier">tainted</span>=<span class="ruby-keyword kw">true</span>
196:         <span class="ruby-keyword kw">end</span>
197:       <span class="ruby-keyword kw">end</span>
198: 
199:       <span class="ruby-comment cmt">#gsmchar=c[0]</span>
200:       <span class="ruby-comment cmt">#puts &quot;#{c} : #{gsmchar} xxx&quot;</span>
201:       <span class="ruby-comment cmt">#gsmchar=@gsmtable[&quot; &quot;] if gsmchar.nil?</span>
202: 
203:       <span class="ruby-identifier">tmp</span>= <span class="ruby-identifier">gsmchar</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-value">2</span>)
204: 
205:       <span class="ruby-identifier">resto</span>=<span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">%</span><span class="ruby-value">7</span>
206:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">resto!</span>=<span class="ruby-value">0</span>
207:         <span class="ruby-identifier">nfillbits</span>=<span class="ruby-value">7</span><span class="ruby-operator">-</span><span class="ruby-identifier">resto</span> <span class="ruby-comment cmt"># 8 ou 7??</span>
208:         <span class="ruby-identifier">tmp</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">*</span><span class="ruby-identifier">nfillbits</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>
209:       <span class="ruby-keyword kw">end</span>
210: 
211:       <span class="ruby-comment cmt"># if adding this character exceeds the max allowed nr of bytes, break</span>
212:       <span class="ruby-keyword kw">if</span> ((<span class="ruby-identifier">tmp</span><span class="ruby-operator">+</span><span class="ruby-identifier">ext</span><span class="ruby-operator">+</span><span class="ruby-identifier">s</span>).<span class="ruby-identifier">length</span><span class="ruby-operator">*</span><span class="ruby-value">1.0</span><span class="ruby-operator">/</span><span class="ruby-value">8</span>).<span class="ruby-identifier">ceil</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">max_bytes</span>
213:         <span class="ruby-keyword kw">break</span>
214:       <span class="ruby-keyword kw">end</span>
215: 
216:       <span class="ruby-identifier">s</span>=<span class="ruby-identifier">tmp</span><span class="ruby-operator">+</span><span class="ruby-identifier">ext</span><span class="ruby-operator">+</span><span class="ruby-identifier">s</span>
217: 
218:       <span class="ruby-comment cmt"># if reached the max allowed nr of bytes, break</span>
219:       <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">*</span><span class="ruby-value">1.0</span><span class="ruby-operator">/</span><span class="ruby-value">8</span>).<span class="ruby-identifier">ceil</span><span class="ruby-operator">==</span><span class="ruby-identifier">max_bytes</span>
220:         <span class="ruby-identifier">idx</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
221:         <span class="ruby-keyword kw">break</span>
222:       <span class="ruby-keyword kw">end</span>
223:       
224:       <span class="ruby-identifier">idx</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
225:     }
226: 
227: 
228:     <span class="ruby-identifier">required_septets</span>=<span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">/</span><span class="ruby-value">7</span>
229:     <span class="ruby-identifier">resto</span>=<span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">%</span><span class="ruby-value">8</span>
230:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">resto!</span>=<span class="ruby-value">0</span>
231:       <span class="ruby-identifier">nfillbits</span>=<span class="ruby-value">8</span><span class="ruby-operator">-</span><span class="ruby-identifier">resto</span>
232:       <span class="ruby-identifier">s</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">*</span><span class="ruby-identifier">nfillbits</span><span class="ruby-operator">+</span><span class="ruby-identifier">s</span>
233:     <span class="ruby-keyword kw">end</span>
234: 
235:     <span class="ruby-comment cmt">#puts &quot;S: #{s}&quot;</span>
236: 
237:     <span class="ruby-identifier">i</span>=<span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">8</span>
238:     <span class="ruby-identifier">hexstr</span>=<span class="ruby-value str">&quot;&quot;</span>
239:     <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">i</span><span class="ruby-operator">&gt;=</span><span class="ruby-value">0</span>
240:       <span class="ruby-identifier">c</span>=<span class="ruby-identifier">s</span>[<span class="ruby-identifier">i</span>,<span class="ruby-value">8</span>]
241: 
242:       <span class="ruby-identifier">tmp</span>=<span class="ruby-identifier">c</span>.<span class="ruby-identifier">to_i</span>(<span class="ruby-value">2</span>).<span class="ruby-identifier">to_s</span>(<span class="ruby-value">16</span>).<span class="ruby-identifier">upcase</span>
243:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">==</span><span class="ruby-value">1</span>
244:         <span class="ruby-identifier">tmp</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>
245:       <span class="ruby-keyword kw">end</span>
246: <span class="ruby-comment cmt">#      puts tmp</span>
247:       <span class="ruby-identifier">hexstr</span><span class="ruby-operator">+=</span><span class="ruby-identifier">tmp</span>
248:       <span class="ruby-identifier">i</span><span class="ruby-operator">-=</span><span class="ruby-value">8</span>
249:     <span class="ruby-keyword kw">end</span>
250: 
251: 
252:     <span class="ruby-keyword kw">return</span> <span class="ruby-constant">GsmPackedMsg</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hexstr</span>,<span class="ruby-identifier">str</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">idx</span>],<span class="ruby-identifier">idx</span>,<span class="ruby-identifier">required_septets</span>,<span class="ruby-identifier">tainted</span>)
253:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000085" class="method-detail">
        <a name="M000085"></a>

        <div class="method-heading">
          <a href="#M000085" class="method-signature">
          <span class="method-name">packoadc</span><span class="method-args">(oa)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000085-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000085-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 473</span>
473:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">packoadc</span>(<span class="ruby-identifier">oa</span>)
474:     <span class="ruby-identifier">packedoa</span>=<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">pack7bits</span>(<span class="ruby-identifier">oa</span>)
475: 
476:     <span class="ruby-comment cmt"># esta conta nao esta correcta... por causa das extensoes...</span>
477:     <span class="ruby-comment cmt">#useful_nibbles=packedoa.length</span>
478:     <span class="ruby-identifier">useful_nibbles</span>=(<span class="ruby-identifier">oa</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">*</span><span class="ruby-value">7.0</span><span class="ruby-operator">/</span><span class="ruby-value">4</span>).<span class="ruby-identifier">ceil</span>
479: 
480:       <span class="ruby-identifier">tmp</span>=<span class="ruby-identifier">useful_nibbles</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-value">16</span>).<span class="ruby-identifier">upcase</span>
481:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">==</span><span class="ruby-value">1</span>
482:         <span class="ruby-identifier">tmp</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>
483:       <span class="ruby-keyword kw">end</span>
484: 
485:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">tmp</span><span class="ruby-operator">+</span><span class="ruby-identifier">packedoa</span>
486:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000084" class="method-detail">
        <a name="M000084"></a>

        <div class="method-heading">
          <a href="#M000084" class="method-signature">
          <span class="method-name">packucs2</span><span class="method-args">(str)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000084-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000084-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 456</span>
456:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">packucs2</span>(<span class="ruby-identifier">str</span>)
457:     <span class="ruby-identifier">hexstr</span>=<span class="ruby-value str">&quot;&quot;</span>
458:     <span class="ruby-identifier">s</span>= <span class="ruby-constant">Iconv</span>.<span class="ruby-identifier">iconv</span>(<span class="ruby-value str">&quot;ucs-2be&quot;</span>, <span class="ruby-value str">&quot;utf-8&quot;</span>, <span class="ruby-identifier">str</span>).<span class="ruby-identifier">first</span>
459:     <span class="ruby-identifier">s</span>.<span class="ruby-identifier">each_char</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
460: 
461:       <span class="ruby-identifier">tmp</span>=<span class="ruby-identifier">c</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span>(<span class="ruby-value">16</span>).<span class="ruby-identifier">upcase</span>
462:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tmp</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">==</span><span class="ruby-value">1</span>
463:         <span class="ruby-identifier">tmp</span>=<span class="ruby-value str">&quot;0&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">tmp</span>
464:       <span class="ruby-keyword kw">end</span>
465: 
466:       <span class="ruby-identifier">hexstr</span><span class="ruby-operator">+=</span><span class="ruby-identifier">tmp</span>
467: 
468:     }
469:     <span class="ruby-comment cmt">#puts s</span>
470:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">hexstr</span>
471:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000091" class="method-detail">
        <a name="M000091"></a>

        <div class="method-heading">
          <a href="#M000091" class="method-signature">
          <span class="method-name">parse_str</span><span class="method-args">(ustr)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
usado para construir um <a href="UCP.html">UCP</a> duma string
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000091-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000091-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 623</span>
623:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse_str</span>(<span class="ruby-identifier">ustr</span>)
624:     <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;parse_str(#{ustr})&quot;</span>
625: 
626:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">ustr</span>.<span class="ruby-identifier">nil?</span>
627:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
628:     <span class="ruby-keyword kw">end</span>
629: 
630:     <span class="ruby-identifier">arr</span>=<span class="ruby-identifier">ustr</span>[(<span class="ruby-identifier">ustr</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value">2</span>.<span class="ruby-identifier">chr</span>)<span class="ruby-operator">+</span><span class="ruby-value">1</span>)<span class="ruby-operator">..</span><span class="ruby-value">-2</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;/&quot;</span>)
631:     <span class="ruby-identifier">trn</span>=<span class="ruby-identifier">arr</span>[<span class="ruby-value">0</span>]
632:     <span class="ruby-comment cmt">#puts &quot;#{trn}&quot;</span>
633:     <span class="ruby-comment cmt"># length</span>
634:     <span class="ruby-identifier">operation_type</span>=<span class="ruby-identifier">arr</span>[<span class="ruby-value">2</span>]
635:     <span class="ruby-comment cmt">#puts &quot;#{operation_type}&quot;</span>
636:     <span class="ruby-identifier">operation</span>=<span class="ruby-identifier">arr</span>[<span class="ruby-value">3</span>]
637:     <span class="ruby-comment cmt">#puts &quot;#{operation}&quot;</span>
638: 
639:     <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-keyword kw">nil</span>
640: 
641:     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;01&quot;</span>)
642:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
643:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;a fazer parsing a uma operacao ucp01&quot;</span>
644:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp01Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
645:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
646:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;a fazer parsing a um resultado ucp01&quot;</span>
647:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp01Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)        
648:       <span class="ruby-keyword kw">end</span>
649:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;30&quot;</span>)
650:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
651:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;a fazer parsing a uma operacao ucp30&quot;</span>
652:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp30Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
653:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
654:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a um resultado ucp30&quot;</span>
655:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp30Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
656:       <span class="ruby-keyword kw">end</span>
657:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;31&quot;</span>)
658:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
659:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a uma operacao ucp31&quot;</span>
660:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp31Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
661:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
662:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a um resultado ucp31&quot;</span>
663:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp31Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
664:       <span class="ruby-keyword kw">end</span>
665:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;51&quot;</span>)
666:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
667:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a uma operacao ucp51&quot;</span>
668:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp51Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
669:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
670:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a um resultado ucp51&quot;</span>
671:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp51Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
672:       <span class="ruby-keyword kw">end</span>
673:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;52&quot;</span>)
674:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
675:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a uma operacao ucp52&quot;</span>
676:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp52Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
677:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
678:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a um resultado ucp52&quot;</span>
679:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp52Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
680:       <span class="ruby-keyword kw">end</span>
681:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;53&quot;</span>)
682:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
683:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a uma operacao ucp53&quot;</span>
684:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp53Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
685:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
686:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a um resultado ucp53&quot;</span>
687:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp53Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
688:       <span class="ruby-keyword kw">end</span>
689:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;54&quot;</span>)
690:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
691:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a uma operacao ucp54&quot;</span>
692:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp54Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
693:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
694:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a um resultado ucp54&quot;</span>
695:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp54Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
696:       <span class="ruby-keyword kw">end</span>
697:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;55&quot;</span>)
698:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
699:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a uma operacao ucp55&quot;</span>
700:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp55Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
701:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
702:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a um resultado ucp55&quot;</span>
703:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp55Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
704:       <span class="ruby-keyword kw">end</span>
705:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;56&quot;</span>)
706:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
707:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a uma operacao ucp56&quot;</span>
708:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp56Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
709:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
710:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a um resultado ucp56&quot;</span>
711:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp56Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
712:       <span class="ruby-keyword kw">end</span>
713:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;57&quot;</span>)
714:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
715:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a uma operacao ucp57&quot;</span>
716:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp57Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
717:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
718:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a um resultado ucp57&quot;</span>
719:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp57Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
720:       <span class="ruby-keyword kw">end</span>
721:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;58&quot;</span>)
722:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
723:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a uma operacao ucp58&quot;</span>
724:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp58Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
725:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
726:         <span class="ruby-comment cmt">#puts &quot;a fazer parsing a um resultado ucp58&quot;</span>
727:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp58Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
728:       <span class="ruby-keyword kw">end</span>
729:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;60&quot;</span>)
730:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
731:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;a fazer parsing a uma operacao ucp60&quot;</span>
732:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp60Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
733:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
734:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;a fazer parsing a um resultado ucp60&quot;</span>
735:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp60Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
736:       <span class="ruby-keyword kw">end</span>
737:     <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;61&quot;</span>)
738:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;O&quot;</span>)
739:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;a fazer parsing a uma operacao ucp61&quot;</span>
740:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp61Operation</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
741:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">operation_type</span>.<span class="ruby-identifier">eql?</span>(<span class="ruby-value str">&quot;R&quot;</span>)
742:         <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;a fazer parsing a um resultado ucp61&quot;</span>
743:         <span class="ruby-identifier">ucpmsg</span>=<span class="ruby-constant">Ucp61Result</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">arr</span>)
744:       <span class="ruby-keyword kw">end</span>
745:     <span class="ruby-keyword kw">end</span>
746: 
747:     <span class="ruby-comment cmt">#ucpmsg.trn=trn</span>
748:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">ucpmsg</span>
749:   <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000081" class="method-detail">
        <a name="M000081"></a>

        <div class="method-heading">
          <a href="#M000081" class="method-signature">
          <span class="method-name">str2ucs2</span><span class="method-args">(str,max_bytes=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000081-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000081-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 365</span>
365: <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">str2ucs2</span>(<span class="ruby-identifier">str</span>,<span class="ruby-identifier">max_bytes</span>=<span class="ruby-keyword kw">nil</span>)
366:   <span class="ruby-identifier">hexstr</span>=<span class="ruby-value str">&quot;&quot;</span>
367:   <span class="ruby-identifier">str</span>=<span class="ruby-constant">Iconv</span>.<span class="ruby-identifier">iconv</span>(<span class="ruby-value str">&quot;utf-16be&quot;</span>, <span class="ruby-value str">&quot;utf-8&quot;</span>, <span class="ruby-identifier">str</span>).<span class="ruby-identifier">first</span>
368:   <span class="ruby-identifier">i</span>=<span class="ruby-value">0</span>
369:   <span class="ruby-identifier">str</span>.<span class="ruby-identifier">each_byte</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
370:     <span class="ruby-identifier">hexstr</span><span class="ruby-operator">+=</span><span class="ruby-constant">UCP</span>.<span class="ruby-identifier">int2hex</span>(<span class="ruby-identifier">c</span>)
371:     <span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
372:     <span class="ruby-keyword kw">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">max_bytes</span>.<span class="ruby-identifier">nil?</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">i</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">max_bytes</span>)
373:       <span class="ruby-keyword kw">break</span>
374:     <span class="ruby-keyword kw">end</span>
375:   }
376: 
377:   <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Ucs2PackedMsg</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">hexstr</span>,<span class="ruby-constant">UCP</span>.<span class="ruby-identifier">utf8_substr</span>(<span class="ruby-identifier">str</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>),<span class="ruby-identifier">i</span><span class="ruby-operator">/</span><span class="ruby-value">2</span>,<span class="ruby-identifier">i</span>)
378: <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000079" class="method-detail">
        <a name="M000079"></a>

        <div class="method-heading">
          <a href="#M000079" class="method-signature">
          <span class="method-name">utf8_substr</span><span class="method-args">(str,idxs,idxe=nil)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000079-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000079-source">
<pre>
     <span class="ruby-comment cmt"># File lib/ucp/util/ucp.rb, line 319</span>
319: <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">utf8_substr</span>(<span class="ruby-identifier">str</span>,<span class="ruby-identifier">idxs</span>,<span class="ruby-identifier">idxe</span>=<span class="ruby-keyword kw">nil</span>)
320:   <span class="ruby-identifier">s</span>=<span class="ruby-value str">&quot;&quot;</span>
321:   <span class="ruby-identifier">i</span>=<span class="ruby-value">0</span>
322:   <span class="ruby-identifier">idxe</span>=<span class="ruby-identifier">str</span>.<span class="ruby-identifier">jlength</span><span class="ruby-operator">-</span><span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">idxe</span>.<span class="ruby-identifier">nil?</span>
323:   <span class="ruby-identifier">str</span>.<span class="ruby-identifier">each_char</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
324:     <span class="ruby-identifier">s</span><span class="ruby-operator">+=</span><span class="ruby-identifier">c</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">i</span><span class="ruby-operator">&gt;=</span><span class="ruby-identifier">idxs</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">i</span><span class="ruby-operator">&lt;=</span><span class="ruby-identifier">idxe</span>
325:     <span class="ruby-identifier">i</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
326:   }
327:   <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">s</span>
328: <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>